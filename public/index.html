<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TO$$KN: Space Coin Flip</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Exo+2:wght@400;700&display=swap');
        
        body {
            margin: 0;
            padding: 0;
            font-family: 'Exo 2', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #loginContainer, #gameContainer {
            width: 100%;
            max-width: 400px;
            padding: 20px;
            box-sizing: border-box;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        #profile {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        #username {
            font-size: 1.2em;
            font-weight: bold;
            color: #fff;
        }
        #profit {
            background: linear-gradient(90deg, #FFD700, #FFA500);
            padding: 5px 15px;
            border-radius: 20px;
            color: #000;
            font-weight: bold;
        }
        .daily-rewards {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .reward-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 15px;
            text-align: center;
            width: 30%;
        }
        #coinContainer {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
        }
        #coinContainer::after {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, #ff00ff, #00ffff);
            border-radius: 50%;
            z-index: -1;
            filter: blur(20px);
            opacity: 0.7;
        }
        .buttons {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        button {
            font-family: 'Exo 2', sans-serif;
            font-size: 1rem;
            padding: 12px 25px;
            background: linear-gradient(135deg, #4cd137, #44bd32);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 209, 55, 0.3);
        }
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(76, 209, 55, 0.4);
        }
        #betContainer {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 25px;
        }
        #betAmount {
            font-size: 1.2em;
            margin: 0 15px;
        }
        #actionButtons {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        #actionButtons button {
            background: linear-gradient(135deg, #9c27b0, #3f51b5);
            width: 22%;
            padding: 10px 0;
            font-size: 0.8em;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #actionButtons button::before {
            content: 'ðŸš€';
            font-size: 1.5em;
            margin-bottom: 5px;
        }
        .login-button {
            background: linear-gradient(45deg, #ff00e0, #00ffff) !important;
            font-size: 1.2em !important;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="loginContainer">
        <h1 style="text-align: center; color: #FFD700;">TO$$KN Space Flip</h1>
        <p style="text-align: center; color: #a0a0a0;">Embark on a cosmic journey of chance!</p>
        <button class="login-button" onclick="login()">Launch with Telegram</button>
    </div>

    <div id="gameContainer" style="display: none;">
        <div id="profile">
            <div id="username">Username</div>
            <div id="profit">Profit: 0</div>
        </div>
        <div class="daily-rewards">
            <div class="reward-box">
                <div>DAILY REWARD</div>
                <div>3000</div>
            </div>
            <div class="reward-box">
                <div>DAILY COMBO</div>
                <div>2x10</div>
            </div>
            <div class="reward-box">
                <div>DAILY BOOST</div>
                <div>500</div>
            </div>
        </div>
        <div id="coinContainer"></div>
        <div class="buttons">
            <button onclick="flipCoin('heads')">HEADS</button>
            <button onclick="flipCoin('tails')">TAILS</button>
        </div>
        <div id="betContainer">
            <button onclick="changeBet(-10)">-</button>
            <div id="betAmount">Bet: 10 TO$$K</div>
            <button onclick="changeBet(10)">+</button>
        </div>
        <div id="actionButtons">
            <button onclick="showMine()">Mine</button>
            <button onclick="showFriends()">Friends</button>
            <button onclick="showEarn()">Earn</button>
            <button onclick="showAirdrop()">Airdrop</button>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        let scene, camera, renderer, coin;
        let betAmount = 10;
        let profit = 0;

        function login() {
            if (tg.initDataUnsafe.user) {
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('gameContainer').style.display = 'block';
                document.getElementById('username').textContent = tg.initDataUnsafe.user.username || "Space Cadet";
                init();
            } else {
                alert('Unable to get user information. Please try again.');
            }
        }

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(200, 200);
            document.getElementById('coinContainer').appendChild(renderer.domElement);

            const geometry = new THREE.CylinderGeometry(1, 1, 0.1, 32);
            const material = new THREE.MeshPhongMaterial({
                color: 0xffd700,
                specular: 0xffffff,
                shininess: 100,
            });
            coin = new THREE.Mesh(geometry, material);
            scene.add(coin);

            const light = new THREE.PointLight(0xffffff, 1, 100);
            light.position.set(0, 0, 10);
            scene.add(light);

            camera.position.z = 5;

            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            coin.rotation.y += 0.01;
            renderer.render(scene, camera);
        }

        function flipCoin(choice) {
            coin.rotation.x = 0;
            const flipDuration = 1000;
            const startTime = Date.now();

            function animateFlip() {
                const elapsedTime = Date.now() - startTime;
                const progress = elapsedTime / flipDuration;

                if (progress < 1) {
                    coin.rotation.x = progress * Math.PI * 10;
                    requestAnimationFrame(animateFlip);
                } else {
                    const outcome = Math.random() < 0.5 ? 'heads' : 'tails';
                    coin.rotation.x = outcome === 'heads' ? 0 : Math.PI;
                    
                    if (outcome === choice) {
                        profit += betAmount;
                        alert(`You won ${betAmount} TO$$K!`);
                    } else {
                        profit -= betAmount;
                        alert(`You lost ${betAmount} TO$$K.`);
                    }
                    updateProfit();
                }
            }

            animateFlip();
        }

        function changeBet(amount) {
            betAmount = Math.max(10, betAmount + amount);
            document.getElementById('betAmount').textContent = `Bet: ${betAmount} TO$$K`;
        }

        function updateProfit() {
            document.getElementById('profit').textContent = `Profit: ${profit}`;
        }

        function showMine() { alert("Mine feature coming soon!"); }
        function showFriends() { alert("Friends feature coming soon!"); }
        function showEarn() { alert("Earn feature coming soon!"); }
        function showAirdrop() { alert("Airdrop feature coming soon!"); }

        tg.expand();
    </script>
</body>
</html>
